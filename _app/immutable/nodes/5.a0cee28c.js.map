{"version":3,"file":"5.a0cee28c.js","sources":["../../../../../../src/lib/components/ActionString.svelte","../../../../../../src/routes/config/chords/action-selector.ts","../../../../../../src/routes/config/chords/input-converter.ts","../../../../../../src/routes/config/chords/ChordPhraseEdit.svelte","../../../../../../src/routes/config/chords/ChordActionEdit.svelte","../../../../../../src/routes/config/chords/ChordEdit.svelte","../../../../../../src/routes/config/chords/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import Action from \"$lib/components/Action.svelte\"\n  import type {KeyInfo} from \"$lib/serial/keymap-codes\"\n\n  export let actions: Array<number | KeyInfo>\n  export let display: \"keys\" | \"inline-keys\" = \"inline-keys\"\n</script>\n\n{#each actions as action, i (`${typeof action === \"number\" ? action : action.code}:${i}`)}\n  <Action {action} {display} />\n{/each}\n","import ActionSelector from \"$lib/components/layout/ActionSelector.svelte\"\nimport {tick} from \"svelte\"\n\nexport function selectAction(\n  event: MouseEvent | KeyboardEvent,\n  select: (action: number) => void,\n  dismissed?: () => void,\n) {\n  const component = new ActionSelector({target: document.body})\n  const dialog = document.querySelector(\"dialog > div\") as HTMLDivElement\n  const backdrop = document.querySelector(\"dialog\") as HTMLDialogElement\n  const dialogRect = dialog.getBoundingClientRect()\n  const groupRect = (event.target as HTMLElement).getBoundingClientRect()\n\n  const scale = 0.5\n  const dialogScale = `${1 - scale * (1 - groupRect.width / dialogRect.width)} ${\n    1 - scale * (1 - groupRect.height / dialogRect.height)\n  }`\n  const dialogTranslate = `${scale * (groupRect.x - dialogRect.x)}px ${\n    scale * (groupRect.y - dialogRect.y)\n  }px`\n\n  const duration = 150\n  const options = {duration, easing: \"ease\"}\n  const dialogAnimation = dialog.animate(\n    [\n      {scale: dialogScale, translate: dialogTranslate},\n      {translate: \"0 0\", scale: \"1\"},\n    ],\n    options,\n  )\n  const backdropAnimation = backdrop.animate([{opacity: 0}, {opacity: 1}], options)\n\n  async function closed() {\n    dialogAnimation.reverse()\n    backdropAnimation.reverse()\n\n    await dialogAnimation.finished\n\n    component.$destroy()\n    await tick()\n    dismissed?.()\n  }\n\n  component.$on(\"close\", closed)\n  component.$on(\"select\", ({detail}) => {\n    select(detail)\n    closed()\n  })\n}\n","import {KEYMAP_IDS, KEYMAP_KEYCODES, specialKeycodes} from \"$lib/serial/keymap-codes\"\n\nexport function inputToAction(event: KeyboardEvent, useKeycodes?: boolean): number | undefined {\n  if (useKeycodes) {\n    return KEYMAP_KEYCODES.get(event.code)\n  } else {\n    return KEYMAP_IDS.get(event.key)?.code ?? specialKeycodes.get(event.key)\n  }\n}\n","<script lang=\"ts\">\n  import {KEYMAP_IDS, specialKeycodes} from \"$lib/serial/keymap-codes\"\n  import {tick} from \"svelte\"\n  import ActionSelector from \"$lib/components/layout/ActionSelector.svelte\"\n  import {changes, ChangeType} from \"$lib/undo-redo\"\n  import type {ChordInfo} from \"$lib/undo-redo\"\n  import {scale} from \"svelte/transition\"\n  import ActionString from \"$lib/components/ActionString.svelte\"\n  import {selectAction} from \"./action-selector\"\n  import {inputToAction} from \"./input-converter\"\n  import {serialPort} from \"$lib/serial/connection\"\n  import {get} from \"svelte/store\"\n\n  export let chord: ChordInfo\n\n  function keypress(event: KeyboardEvent) {\n    if (event.key === \"ArrowUp\") {\n      addSpecial(event)\n    } else if (event.key === \"ArrowLeft\") {\n      moveCursor(cursorPosition - 1)\n    } else if (event.key === \"ArrowRight\") {\n      moveCursor(cursorPosition + 1)\n    } else if (event.key === \"Backspace\") {\n      deleteAction(cursorPosition - 1)\n      moveCursor(cursorPosition - 1)\n    } else if (event.key === \"Delete\") {\n      deleteAction(cursorPosition)\n    } else {\n      const action = inputToAction(event, get(serialPort)?.device === \"X\")\n      if (action !== undefined) {\n        insertAction(cursorPosition, action)\n        tick().then(() => moveCursor(cursorPosition + 1))\n      }\n    }\n  }\n\n  function moveCursor(to: number) {\n    cursorPosition = Math.max(0, Math.min(to, chord.phrase.length))\n    const item = box.children.item(cursorPosition) as HTMLElement\n    cursorOffset = item.offsetLeft + item.offsetWidth\n  }\n\n  function deleteAction(at: number, count = 1) {\n    if (!(at in chord.phrase)) return\n    changes.update(changes => {\n      changes.push({\n        type: ChangeType.Chord,\n        id: chord.id,\n        actions: chord.actions,\n        phrase: chord.phrase.toSpliced(at, count),\n      })\n      return changes\n    })\n  }\n\n  function insertAction(at: number, action: number) {\n    changes.update(changes => {\n      changes.push({\n        type: ChangeType.Chord,\n        id: chord.id,\n        actions: chord.actions,\n        phrase: chord.phrase.toSpliced(at, 0, action),\n      })\n      return changes\n    })\n  }\n\n  function clickCursor(event: MouseEvent) {\n    if (event.target === button) return\n    const distance = (event as unknown as {layerX: number}).layerX\n\n    let i = 0\n    for (const child of box.children) {\n      const {offsetLeft, offsetWidth} = child as HTMLElement\n      if (distance < offsetLeft + offsetWidth / 2) {\n        moveCursor(i - 1)\n        return\n      }\n      i++\n    }\n    moveCursor(i - 1)\n  }\n\n  function addSpecial(event: MouseEvent | KeyboardEvent) {\n    selectAction(\n      event,\n      action => {\n        insertAction(cursorPosition, action)\n        tick().then(() => moveCursor(cursorPosition + 1))\n      },\n      () => box.focus(),\n    )\n  }\n\n  let button: HTMLButtonElement\n  let box: HTMLDivElement\n  let cursorPosition = 0\n  let cursorOffset = 0\n\n  let hasFocus = false\n</script>\n\n<div\n  on:keydown={keypress}\n  on:mousedown={clickCursor}\n  role=\"textbox\"\n  tabindex=\"0\"\n  bind:this={box}\n  class:edited={!chord.deleted && chord.phraseChanged}\n  on:focusin={() => (hasFocus = true)}\n  on:focusout={event => {\n    if (event.relatedTarget !== button) hasFocus = false\n  }}\n>\n  {#if hasFocus}\n    <div transition:scale class=\"cursor\" style:translate=\"{cursorOffset}px 0\">\n      <button class=\"icon\" bind:this={button} on:click={addSpecial}>add</button>\n    </div>\n  {:else}\n    <div />\n    <!-- placeholder for cursor placement -->\n  {/if}\n  <ActionString actions={chord.phrase} />\n  <sup>â€¢</sup>\n</div>\n\n<style lang=\"scss\">\n  sup {\n    translate: 0 -40%;\n    opacity: 0;\n    transition: opacity 250ms ease;\n  }\n\n  .cursor {\n    position: absolute;\n    transform: translateX(-50%);\n    translate: 0 0;\n\n    width: 2px;\n    height: 100%;\n\n    background: var(--md-sys-color-on-secondary-container);\n\n    transition: translate 50ms ease;\n\n    button {\n      position: absolute;\n      top: -24px;\n      left: 0;\n\n      height: 24px;\n      padding: 0;\n\n      color: var(--md-sys-color-on-secondary-container);\n\n      background: var(--md-sys-color-secondary-container);\n      border: 2px solid currentcolor;\n      border-radius: 12px 12px 12px 0;\n    }\n  }\n\n  .edited {\n    color: var(--md-sys-color-primary);\n\n    sup {\n      opacity: 1;\n    }\n  }\n\n  [role=\"textbox\"] {\n    cursor: text;\n\n    position: relative;\n\n    display: flex;\n    align-items: center;\n\n    height: 1em;\n    padding-block: 4px;\n\n    &::after,\n    &::before {\n      content: \"\";\n\n      position: absolute;\n      bottom: -4px;\n\n      width: 100%;\n      height: 1px;\n\n      opacity: 0;\n      background: currentcolor;\n\n      transition:\n        opacity 150ms ease,\n        scale 250ms ease;\n    }\n\n    &::after {\n      scale: 0 1;\n      transition-duration: 250ms;\n    }\n\n    &:hover::before {\n      opacity: 0.3;\n    }\n\n    &:focus-within {\n      outline: none;\n\n      &::after {\n        scale: 1;\n        opacity: 1;\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import type {ChordInfo} from \"$lib/undo-redo\"\n  import {changes, ChangeType} from \"$lib/undo-redo\"\n  import {createEventDispatcher} from \"svelte\"\n  import LL from \"../../../i18n/i18n-svelte\"\n  import ActionString from \"$lib/components/ActionString.svelte\"\n  import {selectAction} from \"./action-selector\"\n  import {serialPort} from \"$lib/serial/connection\"\n  import {get} from \"svelte/store\"\n  import {inputToAction} from \"./input-converter\"\n\n  export let chord: ChordInfo | undefined = undefined\n\n  const dispatch = createEventDispatcher()\n\n  let pressedKeys = new Set<number>()\n  let editing = false\n\n  function compare(a: number, b: number) {\n    return a - b\n  }\n\n  function edit() {\n    pressedKeys = new Set()\n    editing = true\n  }\n\n  function keydown(event: KeyboardEvent) {\n    if (!editing) return\n    event.preventDefault()\n    pressedKeys.add(inputToAction(event, get(serialPort)?.device === \"X\")!)\n    pressedKeys = pressedKeys\n  }\n\n  function keyup() {\n    if (!editing) return\n    editing = false\n    if (pressedKeys.size < 2) return\n    if (!chord) return dispatch(\"submit\", [...pressedKeys].sort(compare))\n    changes.update(changes => {\n      changes.push({\n        type: ChangeType.Chord,\n        id: chord!.id,\n        actions: [...pressedKeys].sort(compare),\n        phrase: chord!.phrase,\n      })\n      return changes\n    })\n  }\n\n  function addSpecial(event: MouseEvent) {\n    selectAction(event, action => {\n      changes.update(changes => {\n        changes.push({\n          type: ChangeType.Chord,\n          id: chord!.id,\n          actions: [...chord!.actions, action].sort(compare),\n          phrase: chord!.phrase,\n        })\n        return changes\n      })\n    })\n  }\n</script>\n\n<button\n  class:deleted={chord && chord.deleted}\n  class:edited={chord && chord.actionsChanged}\n  class:invalid={chord && chord.actions.toSorted(compare).some((it, i) => chord?.actions[i] !== it)}\n  class=\"chord\"\n  on:click={edit}\n  on:keydown={keydown}\n  on:keyup={keyup}\n>\n  {#if editing && pressedKeys.size === 0}\n    <span>{$LL.configure.chords.HOLD_KEYS()}</span>\n  {:else if !editing && !chord}\n    <span>{$LL.configure.chords.NEW_CHORD()}</span>\n  {/if}\n  <ActionString display=\"keys\" actions={editing ? [...pressedKeys].sort(compare) : chord?.actions ?? []} />\n  <button class=\"icon add\" on:click|stopPropagation={addSpecial}>add_circle</button>\n  <sup>â€¢</sup>\n</button>\n\n<style lang=\"scss\">\n  span {\n    opacity: 0.5;\n  }\n\n  sup {\n    translate: 0 -60%;\n    opacity: 0;\n    transition: opacity 250ms ease;\n  }\n\n  .add {\n    font-size: 18px;\n    margin-inline-start: 4px;\n    height: 20px;\n    opacity: 0;\n    --icon-fill: 1;\n  }\n\n  .chord:hover .add {\n    opacity: 1;\n  }\n\n  .chord {\n    position: relative;\n\n    display: inline-flex;\n    gap: 4px;\n\n    height: 32px;\n    margin-inline: 4px;\n\n    &:focus-within {\n      outline: none;\n    }\n  }\n\n  .chord::after {\n    content: \"\";\n\n    position: absolute;\n    top: 50%;\n    transform-origin: center left;\n    translate: -6px 0;\n    scale: 0 1;\n\n    width: calc(100% - 32px);\n    height: 1px;\n\n    background: currentcolor;\n\n    transition:\n      scale 250ms ease,\n      color 250ms ease;\n  }\n\n  .edited {\n    color: var(--md-sys-color-primary);\n\n    & > sup {\n      opacity: 1;\n    }\n  }\n\n  .invalid {\n    color: var(--md-sys-color-error);\n  }\n\n  .deleted {\n    color: var(--md-sys-color-error);\n\n    &::after {\n      scale: 1;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import {changes, ChangeType} from \"$lib/undo-redo.js\"\n  import type {ChordInfo} from \"$lib/undo-redo.js\"\n  import ChordPhraseEdit from \"./ChordPhraseEdit.svelte\"\n  import ChordActionEdit from \"./ChordActionEdit.svelte\"\n  import type {Chord} from \"$lib/serial/chord\"\n  import {slide} from \"svelte/transition\"\n  import {charaFileToUriComponent} from \"$lib/share/share-url\"\n  import SharePopup from \"../SharePopup.svelte\"\n  import tippy from \"tippy.js\"\n\n  export let chord: ChordInfo\n\n  function remove() {\n    changes.update(changes => {\n      changes.push({\n        type: ChangeType.Chord,\n        id: chord.id,\n        actions: chord.actions,\n        phrase: chord.phrase,\n        deleted: true,\n      })\n      return changes\n    })\n  }\n\n  function isSameChord(a: Chord, b: Chord) {\n    return a.actions.length === b.actions.length && a.actions.every((it, i) => it === b.actions[i])\n  }\n\n  function restore() {\n    changes.update(changes => changes.filter(it => !(it.type === ChangeType.Chord && isSameChord(it, chord))))\n  }\n\n  async function share(event: Event) {\n    const url = new URL(window.location.href)\n    url.searchParams.set(\n      \"import\",\n      await charaFileToUriComponent({\n        charaVersion: 1,\n        type: \"chords\",\n        chords: [[chord.actions, chord.phrase]],\n      }),\n    )\n    await navigator.clipboard.writeText(url.toString())\n    let shareComponent: SharePopup\n    tippy(event.target as HTMLElement, {\n      onCreate(instance) {\n        const target = instance.popper.querySelector(\".tippy-content\")!\n        shareComponent = new SharePopup({target})\n      },\n      onHidden(instance) {\n        instance.destroy()\n      },\n      onDestroy(instance) {\n        shareComponent.$destroy()\n      },\n    }).show()\n  }\n</script>\n\n<th>\n  <ChordActionEdit {chord} />\n</th>\n<td>\n  <ChordPhraseEdit {chord} />\n</td>\n<td class=\"table-buttons\">\n  {#if !chord.deleted}\n    <button transition:slide class=\"icon compact\" on:click={remove}>delete</button>\n  {:else}\n    <button transition:slide class=\"icon compact\" on:click={restore}>restore_from_trash</button>\n  {/if}\n  <button class=\"icon compact\" class:disabled={chord.isApplied} on:click={restore}>undo</button>\n  <div class=\"separator\" />\n  <button class=\"icon compact\" on:click={share}>share</button>\n</td>\n\n<style lang=\"scss\">\n  .separator {\n    display: inline-flex;\n\n    width: 1px;\n    height: 24px;\n\n    opacity: 0.2;\n    background: currentcolor;\n  }\n\n  td {\n    position: relative;\n  }\n\n  .table-buttons {\n    opacity: 0;\n    transition: opacity 75ms ease;\n  }\n\n  :global(tr):focus-within > .table-buttons,\n  :global(tr):hover > .table-buttons {\n    opacity: 1;\n  }\n</style>\n","<script lang=\"ts\">\n  import {KEYMAP_CODES} from \"$lib/serial/keymap-codes\"\n  import Index from \"flexsearch\"\n  import LL from \"../../../i18n/i18n-svelte\"\n  import {action} from \"$lib/title\"\n  import {onDestroy, onMount, setContext} from \"svelte\"\n  import {changes, ChangeType, chords} from \"$lib/undo-redo\"\n  import type {ChordInfo} from \"$lib/undo-redo\"\n  import {derived, writable} from \"svelte/store\"\n  import ChordEdit from \"./ChordEdit.svelte\"\n  import {crossfade} from \"svelte/transition\"\n  import ChordActionEdit from \"./ChordActionEdit.svelte\"\n\n  const resultSize = 38\n  let results: HTMLElement\n  const pageSize = writable(0)\n  let resizeObserver: ResizeObserver\n\n  onMount(() => {\n    resizeObserver = new ResizeObserver(() => {\n      pageSize.set(Math.floor(results.clientHeight / resultSize))\n    })\n    pageSize.set(Math.floor(results.clientHeight / resultSize))\n    resizeObserver.observe(results)\n  })\n\n  onDestroy(() => {\n    resizeObserver?.disconnect()\n  })\n\n  $: searchIndex = $chords?.length > 0 ? buildIndex($chords) : undefined\n\n  function buildIndex(chords: ChordInfo[]): Index {\n    const index = new Index({tokenize: \"full\"})\n    chords.forEach((chord, i) => {\n      if (\"phrase\" in chord) {\n        index.add(\n          i,\n          chord.phrase\n            .map(it => KEYMAP_CODES[it]?.id)\n            .filter(it => !!it)\n            .join(\"\"),\n        )\n      }\n    })\n    return index\n  }\n\n  const searchFilter = writable<number[] | undefined>(undefined)\n\n  function search(event: Event) {\n    const query = (event.target as HTMLInputElement).value\n    searchFilter.set(query && searchIndex ? searchIndex.search(query) : undefined)\n    page = 0\n  }\n\n  function insertChord(actions: number[]) {\n    const id = JSON.stringify(actions)\n    if ($chords.some(it => JSON.stringify(it.actions) === id)) {\n      alert($LL.configure.chords.DUPLICATE())\n      return\n    }\n    changes.update(changes => {\n      changes.push({\n        type: ChangeType.Chord,\n        id: actions,\n        actions,\n        phrase: [],\n      })\n      return changes\n    })\n  }\n\n  const items = derived(\n    [searchFilter, chords],\n    ([filter, chords]) =>\n      filter?.map(it => [chords[it], it] as const) ?? chords.map((it, i) => [it, i] as const),\n  )\n  const lastPage = derived(\n    [items, pageSize],\n    ([items, pageSize]) => Math.ceil((items.length + 1) / pageSize) - 1,\n  )\n\n  setContext(\"cursor-crossfade\", crossfade({}))\n\n  let page = 0\n</script>\n\n<svelte:head>\n  <title>Chord Manager - CharaChorder Device Manager</title>\n  <meta name=\"description\" content=\"Manage your chords\" />\n</svelte:head>\n\n<div class=\"search-container\">\n  <input\n    type=\"search\"\n    placeholder={$LL.configure.chords.search.PLACEHOLDER($chords.length)}\n    on:input={search}\n  />\n  <div class=\"paginator\">\n    {#if $lastPage !== -1}\n      {page + 1} / {$lastPage + 1}\n    {:else}\n      - / -\n    {/if}\n  </div>\n  <button class=\"icon\" on:click={() => (page = Math.max(page - 1, 0))} use:action={{shortcut: \"ctrl+left\"}}\n    >navigate_before</button\n  >\n  <button\n    class=\"icon\"\n    on:click={() => (page = Math.min(page + 1, $lastPage))}\n    use:action={{shortcut: \"ctrl+right\"}}>navigate_next</button\n  >\n</div>\n\n<section bind:this={results}>\n  <table>\n    {#if page === 0}\n      <tr\n        ><th class=\"new-chord\"><ChordActionEdit on:submit={({detail}) => insertChord(detail)} /></th><td /><td\n        /></tr\n      >\n    {/if}\n    {#if $lastPage !== -1}\n      {#each $items.slice(page * $pageSize - (page === 0 ? 0 : 1), (page + 1) * $pageSize - 1) as [chord] (JSON.stringify(chord.id))}\n        <tr>\n          <ChordEdit {chord} />\n        </tr>\n      {/each}\n    {:else}\n      <caption>{$LL.configure.chords.search.NO_RESULTS()}</caption>\n    {/if}\n  </table>\n  <textarea placeholder={$LL.configure.chords.TRY_TYPING()}></textarea>\n</section>\n\n<style lang=\"scss\">\n  .search-container {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .paginator {\n    display: flex;\n    justify-content: flex-end;\n    min-width: 8ch;\n  }\n\n  .new-chord :global(.add) {\n    visibility: hidden;\n  }\n\n  textarea {\n    transition: border-color 250ms ease;\n    background: none;\n    color: inherit;\n    border: 1px dashed var(--md-sys-color-surface-variant);\n    padding: 8px;\n    border-radius: 4px;\n\n    &:focus {\n      outline: none;\n      border-color: var(--md-sys-color-primary);\n    }\n  }\n\n  caption {\n    margin-top: 156px;\n  }\n\n  input[type=\"search\"] {\n    width: 512px;\n    margin-block-start: 16px;\n    padding-block: 8px;\n    padding-inline: 16px;\n\n    font-size: 16px;\n    color: inherit;\n\n    background: none;\n    border: 0 solid var(--md-sys-color-surface-variant);\n    border-bottom-width: 1px;\n\n    transition: all 250ms ease;\n\n    &::placeholder {\n      color: var(--md-sys-color-on-surface-variant);\n      opacity: 0.2;\n    }\n\n    &:focus {\n      border-color: var(--md-sys-color-primary);\n      outline: none;\n    }\n  }\n\n  section {\n    position: relative;\n    display: flex;\n\n    overflow: hidden;\n\n    height: 100%;\n    padding-inline: 8px;\n\n    border-radius: 16px;\n  }\n\n  table {\n    height: fit-content;\n    overflow: hidden;\n    min-width: min(90vw, 16.5cm);\n    transition: all 1s ease;\n  }\n</style>\n"],"names":["ctx","get_key","i","actions","$$props","display","selectAction","event","select","dismissed","component","ActionSelector","dialog","backdrop","dialogRect","groupRect","scale","dialogScale","dialogTranslate","options","dialogAnimation","backdropAnimation","closed","tick","detail","inputToAction","useKeycodes","KEYMAP_KEYCODES","KEYMAP_IDS","specialKeycodes","insert_hydration","target","div","anchor","append_hydration","button_1","toggle_class","sup","dirty","actionstring_changes","chord","keypress","addSpecial","moveCursor","cursorPosition","deleteAction","action","get","serialPort","insertAction","to","item","box","$$invalidate","cursorOffset","at","count","changes","ChangeType","clickCursor","button","distance","child","offsetLeft","offsetWidth","hasFocus","$$value","focusin_handler","t_value","span","set_data","t","create_if_block","create_if_block_1","compare","button1","button0","a","b","dispatch","createEventDispatcher","pressedKeys","editing","edit","keydown","keyup","it","th","td0","td1","isSameChord","remove","restore","share","url","charaFileToUriComponent","shareComponent","tippy","instance","SharePopup","t0_value","t2_value","t0","t2","tr","caption","create_if_block_2","if_block1","attr","textarea","textarea_placeholder_value","meta","div1","input","div0","section","table","action_destroyer","current","resultSize","results","pageSize","writable","resizeObserver","onMount","onDestroy","buildIndex","chords","index","Index","KEYMAP_CODES","searchFilter","search","query","searchIndex","page","insertChord","id","$chords","$LL","items","derived","filter","lastPage","setContext","crossfade","$lastPage"],"mappings":"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"}